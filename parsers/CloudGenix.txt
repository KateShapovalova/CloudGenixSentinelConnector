// Usage Instructions:
// Paste below query in log analytics, click on Save button and select as Function from drop down by specifying function name as CloudGenix and specifying Legacy Category.
// This function maps CloudGenix events to Azure Sentinel Information Model (ASIM) (https://docs.microsoft.com/azure/sentinel/normalization).
// Function usually takes 10-15 minutes to activate. You can then use function alias from any other queries (e.g. CloudGenix | take 10).
// Reference : Using functions in Azure monitor log queries : https://docs.microsoft.com/azure/azure-monitor/log-query/functions
CloudGenix_CL
| extend EventVendor = 'Palo Alto Networks',
         EventProduct = 'CloudGenix',
         EventCount = 1,
         CreatedAt = _created_on_utc_t
| extend EventStartTime = time_t,
        EventEndTime = _updated_on_utc_t,
        Severity = severity_s,
        FaultCode = code_s,
        Description = description_s,
        EventSubType = type_s,
        EventOriginalUid = event_id_s,
        DvcIpAddr = info_remote_ip_s,
        DvcHostname = info_remote_hostname_s,
        CorrelationId = correlation_id_s,
        Site = site_s,
        Entity = info_name_s,
        Element = element_s,
        Reason = info_reason_s,
        SrcAppName = application_s,
        VpnLinks = info_vpnlinks_s,
        CircuitLabels = info_circuit_labels_s,
        Etag = _etag_d,
        Acknowledged = acknowledged_b,
        Cleared = cleared_b,
        ExtendedState = info_extended_state_s,
        ParentInterface = info_parent_interface_s,
        NetworkPolicySets = info_network_policysets_s,
        NetworkPolicySetStack = info_network_policysetstack_id_s,
        NetworkPolicyRules = info_network_policyrules_s,
        MissingLabels = info_missing_labels_s,
        RuleType = info_rule_type_s,
        ConflictAppId = info_conflict_app_id_s,
        Rule1Id = info_rule1_id_s,
        Rule2Id = info_rule2_id_s,
        ApplicationId = info_app_id_s,
        IpAddr = info_ip_address_s,
        MacAddr = info_mac_address_s,
        ProcessName = info_process_name_s,
        Protocol = info_protocol_s,
        ServerInfo = info_server_info_s,
        Details = info_detail_s,
        PeerIp = info_peer_ip_s,
        PeerState = info_peer_state_s,
        PeerType = info_peer_type_s,
        State = info_state_s,
        VpnReasons = info_vpn_reasons_s
|project-away   _created_on_utc_t,
                _etag_d,
                _updated_on_utc_t,
                acknowledged_b,
                cleared_b,
                code_s,
                correlation_id_s,
                severity_s,
                time_t,
                type_s,
                event_id_s,
                description_s,
                site_s,
                info_vpnlinks_s,
                info_circuit_labels_s,
                info_name_s,
                info_reason_s,
                info_remote_hostname_s,
                info_remote_ip_s,
                element_s,
                application_s,
                info_rule1_id_s,
                info_rule2_id_s,
                info_app_id_s,
                info_conflict_app_id_s,
                info_rule_type_s,
                info_extended_state_s,
                info_parent_interface_s,
                info_network_policysets_s,
                info_network_policysetstack_id_s,
                info_network_policyrules_s,
                info_missing_labels_s,
                info_ip_address_s,
                info_mac_address_s,
                info_process_name_s,
                info_protocol_s,
                info_server_info_s,
                info_detail_s,
                info_peer_ip_s,
                info_peer_state_s,
                info_peer_type_s,
                info_elements_s,
                info_state_s,
                info_interface_id_s,
                info_vpn_reasons_s,
                info_element_id_s
